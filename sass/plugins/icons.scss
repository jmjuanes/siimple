@use "sass:map";

@use "../icons.scss" as icons;
@use "../plugins.scss" as plugins;
@use "../utils.scss" as utils;

// @description Icons plugin entrypoint
@function plugin-icons($options: utils.empty-map()) {
    $icons-name: utils.get-in($options, "name", "siimple-icons");
    $icons-path: utils.get-in($options, "path", "../fonts/");
    $include: utils.get-in($options, "include", ());
    $exclude: utils.get-in($options, "exclude", ());
    // Generate icons variants
    $icons-variants: utils.empty-map();
    @each $icon in icons.get-icons() {
        @if plugins.is-enabled($icon, $include, $exclude) {
            $icons-variants: map.set($icons-variants, $icon, (
                "&::before": (
                    "content": icons.include-icon($icon),
                ),
            ));
        }
    }
    // Generate icons plugin
    @return (
        // Icons font
        plugins.create-font-plugin((
            "name": $icons-name,
            "sources": (
                "truetype": "#{$icons-path}#{$icons-name}.ttf",
                "woff": "#{$icons-path}#{$icons-name}.woff",
                //"woff2": "#{$icons-path}#{$icons-name}.woff2",
            ),
            "weight": "normal",
            "style": "normal",
        )),
        // Icons component
        plugins.create-component-plugin((
            "id": "icon",
            "name": "icon",
            "styles": (
                "align-self": center,
                // "display": inline-flex,
                "font-family": $icons-name,
                //"font-size": "default",
                "font-style": normal,
                "font-weight": (normal "important"),
                "line-height": utils.get-in($options, "line-height", 1),
                "text-rendering": auto,
                "-moz-osx-font-smoothing": grayscale,
                "-webkit-font-smoothing": antialiased,
                "&::before": (
                    "box-sizing": border-box, //inherit;
                    "display": block,
                ),
            ),
            "variants": $icons-variants,
        )),
    );
}
